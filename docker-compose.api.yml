version: '3.5'

# This compose file only works when used in conjunction with the default docker-compose file.
# docker compose -f docker-compose.yml -r docker-compose.api.yml

services:
  api:
    container_name: thx_api
    build:
      context: .
      dockerfile: apps/api/Dockerfile
      target: develop
    networks:
      - thx_network
    volumes:
      - ./coverage/apps/api:/usr/src/app/coverage/apps/api
    env_file:
      - apps/api/.env.example
      - apps/api/.env.ci
    ports:
      - 3001:3000
    depends_on:
      - mongo
      - hardhat
networks:
  default:
    name: thx_network
