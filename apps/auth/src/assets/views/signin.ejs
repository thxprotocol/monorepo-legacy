<% if (params.backgroundImgUrl) { %>
<style type="text/css">
  body {
    background-image: url("<%- params.backgroundImgUrl %>") !important;
    background-repeat: no-repeat;
    background-size: cover;
  }
</style>
<% } %>
<div class="col-md-6 offset-md-3 col-xl-4 offset-xl-4 order-0 order-sm-1">
  <div class="text-center pb-4">
    <% if (params.logoImgUrl) { %>
    <img src="<%- params.logoImgUrl %>" width="60" alt="THX Logo" />
    <% } else { %>
    <img src="/img/logo.png" width="60" alt="THX Logo" />
    <% } %>
  </div>
  <div class="card shadow-sm">
    <div class="card-body p-sm-4 pb-sm-0">
      <% if (params.authRequestMessage) { %>
      <div v-if="alert && alert.message" class="alert" :class="`alert-${alert.variant}`">
        <i class="fas fa-exclamation-circle mr-2"></i>
        {{alert.message}}
      </div>
      <% } %>
      <% if (params.authentication_token && params.secure_key) { %> <strong
              class="h2 d-block text-dark text-center mb-4">
        Set a password
      </strong>
      <p>You are invited to access your THX Web Wallet. Set a password and accept the invite!</p>
      <% } %>
      <% if (locals.alert && alert.message) { %>
      <div class="alert alert-<%= alert.variant %>">
        <%- alert.message %>
      </div>
      <% } %>

      <!--
          This part is used for the invite flow
      -->
      <% if (params.authentication_token && params.secure_key) { %>
      <form action="/oidc/<%= uid %>/password" method="post">
        <div class="form-group">
          <label>Password:</label>
          <input class="form-control" required autocomplete type="password" name="password">
        </div>
        <div class="form-group">
          <label>Repeat password:</label>
          <input class="form-control" required autocomplete type="password" name="passwordConfirm">
        </div>
        <div class="form-group">
          <div class="m-0 custom-control custom-checkbox b-custom-control-sm">
            <input id="acceptTermsPrivacy" type="checkbox" name="acceptTermsPrivacy" class="custom-control-input"
                   value="true"><label for="acceptTermsPrivacy" class="custom-control-label font-weight-normal"> I agree
              to
              THX' <a href="<%= publicUrl %>/general-terms-and-conditions.pdf" target="_blank">terms
                of
                use</a> and <a href="<%= publicUrl %>/privacy-policy.pdf" target="_blank">privacy
                statement</a></label>
          </div>
          <div class="custom-control custom-checkbox b-custom-control-sm">
            <input id="acceptUpdates" type="checkbox" name="acceptUpdates" class="custom-control-input" value="true">
            <label for="acceptUpdates" class="custom-control-label font-weight-normal">
              Opt-in to receive updates from THX on its products, you can opt-out at any time.
            </label>
          </div>
        </div>
        <input type="hidden" name="authenticationToken" value="<%= params.authentication_token %>" />
        <input type="hidden" name="secureKey" value="<%= params.secure_key %>" />
        <input type="hidden" name="returnUrl" value="<%= params.return_url %>" />

        <button type="submit" class="btn rounded-pill btn-primary btn-block">
          Accept invite
          <i class="fas fa-chevron-right" aria-hidden="true"></i>
        </button>
      </form>
      <% } else { %>
      <!-- This part is used for regular login flow and only visibile if links are available -->
      <div class="d-flex align-items-center justify-content-start flex-wrap">
        <% if (params.authRequestMessage) { %>
        <a style="width: 40px; height: 40px;" class="mr-2 mb-2 btn d-flex center-center  btn-light" @click="signin()"
           data-toggle="tooltip" title="Sign in with Metamask">
          <img width="25" src="/img/mm-logo.svg" alt="Metamask logo" />
        </a>
        <% } %>
        <% if (params.googleLoginUrl) { %>
        <a style="width: 40px; height: 40px;" class="mr-2 mb-2 btn d-flex center-center btn-light"
           href="<%= params.googleLoginUrl %>" data-toggle="tooltip" title="Sign in with Google">
          <img width="20" src="/img/g-logo.png" alt="Google logo" />
        </a>
        <% } %>
        <% if (params.twitterLoginUrl) { %>
        <a style="width: 40px; height: 40px;" class="mr-2 mb-2  btn d-flex center-center  btn-light"
           href="<%= params.twitterLoginUrl %>" data-toggle="tooltip" title="Sign in with Twitter">
          <img width="20" src="/img/t-logo.png" alt="Twitter logo" />
        </a>
        <% } %>
        <% if (params.discordLoginUrl) { %>
        <a style="width: 40px; height: 40px;" class="mr-2 mb-2  btn d-flex center-center  btn-light"
           href="<%= params.discordLoginUrl %>" data-toggle="tooltip" title="Sign in with Discord">
          <img width="20" src="/img/discord-logo.png" alt="Discord logo" />
        </a>
        <% } %>
        <% if (params.githubLoginUrl) { %>
        <a style="width: 40px; height: 40px;" class="mr-2 mb-2  btn d-flex center-center btn-light"
           href="<%= params.githubLoginUrl %>" data-toggle="tooltip" title="Sign in with Github">
          <img width="20" src="/img/github-logo.png" alt="github logo" />
        </a>
        <% } %>
        <% if (params.twitchLoginUrl) { %>
        <a style="width: 40px; height: 40px;" class="mr-2 mb-2 btn d-flex center-center  btn-light"
           href="<%= params.twitchLoginUrl %>" data-toggle="tooltip" title="Sign in with Twitch">
          <img width="20" src="/img/twitch-logo.png" alt="twitch logo" />
        </a>
        <% } %>
      </div>
      <p class="mt-2 text-muted">Or sign in with</p>
      <!-- This part is used for regular login flow -->
      <form id="form-signin" action="/oidc/<%= uid %>/signin" method="post" class="mt-3">

        <div class="form-group">
          <input placeholder="E-mail" class="form-control" class="form-control" required type="email"
                 value="<%= params.email %>" name="email">
        </div>
        <div class="form-group">
          <input placeholder="Password" class=" form-control" required autocomplete type="password"
                 value="<%= params.password %>" name="password">
        </div>

        <% if (params.mfaEnabled) { %>
        <label>MFA code:</label>
        <input class="form-control mb-4" required name="code">
        <% } %>

        <% if (params.authRequestMessage) { %>
        <input type="hidden" name="authRequestMessage" value="<%= params.authRequestMessage %>" />
        <input type="hidden" name="authRequestSignature" value="" />
        <script type="module" src="/js/signin.js"></script>
        <% } %>

        <input type="hidden" name="returnUrl" value="<%= params.return_url %>" />
        <button type="submit" class="btn rounded-pill btn-primary btn-block" :disabled="isDisabled">
          Sign in
          <i class="fas fa-chevron-right" aria-hidden="true"></i>
        </button>
      </form>
    </div>
    <div class="card-footer mt-0 text-center">
      <a class="btn btn-link p-1" href="/oidc/<%= uid %>/forgot">
        Can't sign in?
      </a>
      <span class="text-muted">|</span>
      <a class="btn btn-link p-1" href="/oidc/<%= uid %>/signup?returnUrl=<%= params.return_url%>">
        Sign up for an account
      </a>
    </div>
    <% } %>
  </div>
</div>